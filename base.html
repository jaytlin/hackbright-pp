<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css">
	</head>
	<body>
		<div id="react-app">
		</div>
		<script src="https://cdn.jsdelivr.net/react/0.14.0-rc1/react.js"></script>
		<script src="https://cdn.jsdelivr.net/react/0.14.0-rc1/react-dom.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
		<script type="text/babel">

			var ContactItem = React.createClass({
				propTypes: {
					name: React.PropTypes.string.isRequired,
					email: React.PropTypes.string.isRequired,
					description: React.PropTypes.string
				},

				render: function() {
					var emailLink = "mailto:" + this.props.email;

					return (
						<li className='ContactItem'>
							<h2 className='ContactItem-name'>{this.props.name}</h2>
							<a href={emailLink} className='ContactItem-email'>{this.props.email}</a>
							<div className='ContactItem-description'>{this.props.description}</div>
						</li>
					)
				},
			});

			var ContactForm = React.createClass({
				propTypes: {
					contact: React.PropTypes.object.isRequired,
					onChange: React.PropTypes.func.isRequired,
					onSubmit: React.PropTypes.func.isRequired
				},

				updateName: function(e) {
					this.props.contact.name = e.target.value;
					this.props.onChange(this.props.contact);
				},

				updateEmail: function(e) {
					this.props.contact.email = e.target.value;
					this.props.onChange(this.props.contact);
				},

				updateDescription: function(e) {
					this.props.contact.description = e.target.value;
					this.props.onChange(this.props.contact);
				},

				onSubmit: function(e) {
					e.preventDefault(); // This prevents the page from refreshing
					this.props.onSubmit();
				},

				render: function() {
					return (
						<form className='ContactForm' onSubmit={this.onSubmit}>
							<input
								placeholder='Name (required)'
								value={this.props.contact.name}
								onChange={this.updateName}/>
							<input
								placeholder='Email (required)'
								value={this.props.contact.email}
								onChange={this.updateEmail}/>
							<textarea
								placeholder='Description'
								value={this.props.contact.description}
								onChange={this.updateDescription}/>
							<button type='submit'>Add Contact</button>
						</form>
					)
				}
			});

			var ContactView = React.createClass({
				getInitialState: function() {
					return {
						contacts: [
							{name: "Jessica Lin", email: "jessica.lin@redfin.com", description: "Occasionally goes by Jaylin"},
							{name: "Luke Misenheimer", email: "luke.misenheimer@redfin.com"},
						],
						newContact: {name: "", email: "", description: ""}
					};
				},

				updateNewContact: function(contact) {
					this.setState({
						newContact: contact
					});
				},

				submitNewContact: function() {
					// Please implement this function
				},

				render: function() {
					var listElements = this.state.contacts
						.map(function(contact) { return <ContactItem {...contact}/>; });

					return (
						<div className='ContactView'>
							<h1 className='ContactView-title'>Contacts</h1>
							<ul className='ContactView-list'>{listElements}</ul>
							<ContactForm 
								contact={this.state.newContact}
								onChange={this.updateNewContact}
								onSubmit={this.submitNewContact}/>
						</div>
					);
				},
			});

			ReactDOM.render(
				<ContactView/>,
				document.getElementById('react-app')
			)
		</script>
	</body>
</html>